"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5443],{59128:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>u,toc:()=>h});var a=n(85893),s=n(11151),r=n(74866),c=n(85162),l=n(71183);const o={id:"advanced-xcc",title:"Complex Cross Contract Call"},i=void 0,u={id:"tutorials/examples/advanced-xcc",title:"Complex Cross Contract Call",description:"This example presents 3 instances of complex cross-contract calls. Particularly, it shows:",source:"@site/../_docs/3.tutorials/examples/advanced-xcc.md",sourceDirName:"3.tutorials/examples",slug:"/tutorials/examples/advanced-xcc",permalink:"/docs/tutorials/examples/advanced-xcc",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../_docs/3.tutorials/examples/advanced-xcc.md",tags:[],version:"current",frontMatter:{id:"advanced-xcc",title:"Complex Cross Contract Call"},sidebar:"tutorials",previous:{title:"Factory",permalink:"/docs/tutorials/examples/factory"},next:{title:"Self Upgrade & State Migration",permalink:"/docs/tutorials/examples/update-contract-migrate-state"}},d={},h=[{value:"Obtaining the Cross Contract Call Example",id:"obtaining-the-cross-contract-call-example",level:2},{value:"Structure of the Example",id:"structure-of-the-example",level:2},{value:"Smart Contract",id:"smart-contract",level:2},{value:"Batch Actions",id:"batch-actions",level:3},{value:"Getting the Last Response",id:"getting-the-last-response",level:4},{value:"Calling Multiple Contracts",id:"calling-multiple-contracts",level:3},{value:"Getting All Responses",id:"getting-all-responses",level:4},{value:"Multiple Calls - Same Result Type",id:"multiple-calls---same-result-type",level:3},{value:"Getting All Responses",id:"getting-all-responses-1",level:4},{value:"Testing the Contract",id:"testing-the-contract",level:3},{value:"Deploying the Contract to the NEAR network",id:"deploying-the-contract-to-the-near-network",level:3},{value:"CLI: Interacting with the Contract",id:"cli-interacting-with-the-contract",level:3}];function p(t){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.p,{children:"This example presents 3 instances of complex cross-contract calls. Particularly, it shows:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"How to batch multiple function calls to a same contract."}),"\n",(0,a.jsx)(e.li,{children:"How to call multiple contracts in parallel, each returning a different type."}),"\n",(0,a.jsx)(e.li,{children:"Different ways of handling the responses in the callback."}),"\n"]}),"\n",(0,a.jsx)(e.admonition,{title:"Simple Cross-Contract Calls",type:"info",children:(0,a.jsxs)(e.p,{children:["Check the tutorial on how to use ",(0,a.jsx)(e.a,{href:"/docs/tutorials/examples/xcc",children:"simple cross-contract calls"})]})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"obtaining-the-cross-contract-call-example",children:"Obtaining the Cross Contract Call Example"}),"\n",(0,a.jsx)(e.p,{children:"You have two options to start the Donation Example:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["You can use the app through ",(0,a.jsx)(e.code,{children:"Github Codespaces"}),", which will open a web-based interactive environment."]}),"\n",(0,a.jsx)(e.li,{children:"Clone the repository locally and use it from your computer."}),"\n"]}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"Codespaces"}),(0,a.jsx)(e.th,{children:"Clone locally"})]})}),(0,a.jsx)(e.tbody,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.a,{href:"https://codespaces.new/near-examples/cross-contract-calls?quickstart=1",children:(0,a.jsx)(e.img,{src:"https://github.com/codespaces/badge.svg",alt:"Open in GitHub Codespaces"})})}),(0,a.jsxs)(e.td,{children:["\ud83c\udf10 ",(0,a.jsx)(e.code,{children:"https://github.com/near-examples/cross-contract-calls"})]})]})})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"structure-of-the-example",children:"Structure of the Example"}),"\n",(0,a.jsx)(e.p,{children:"The smart contract is available in two flavors: Rust and JavaScript"}),"\n",(0,a.jsxs)(r.Z,{groupId:"code-tabs",children:[(0,a.jsx)(c.Z,{value:"js",label:"\ud83c\udf10 JavaScript",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"\u250c\u2500\u2500 sandbox-ts # sandbox testing\n\u2502    \u251c\u2500\u2500 external-contracts\n\u2502    \u2502    \u251c\u2500\u2500 counter.wasm\n\u2502    \u2502    \u251c\u2500\u2500 guest-book.wasm\n\u2502    \u2502    \u2514\u2500\u2500 hello-near.wasm\n\u2502    \u2514\u2500\u2500 main.ava.ts\n\u251c\u2500\u2500 src # contract's code\n\u2502    \u251c\u2500\u2500 internal\n\u2502    \u2502    \u251c\u2500\u2500 batch_actions.ts\n\u2502    \u2502    \u251c\u2500\u2500 constants.ts\n\u2502    \u2502    \u251c\u2500\u2500 multiple_contracts.ts\n\u2502    \u2502    \u251c\u2500\u2500 similar_contracts.ts\n\u2502    \u2502    \u2514\u2500\u2500 utils.ts\n\u2502    \u2514\u2500\u2500 contract.ts\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 tsconfig.json\n"})})}),(0,a.jsx)(c.Z,{value:"rust",label:"\ud83e\udd80 Rust",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"\u250c\u2500\u2500 tests # sandbox testing\n\u2502    \u251c\u2500\u2500 external-contracts\n\u2502    \u2502    \u251c\u2500\u2500 counter.wasm\n\u2502    \u2502    \u251c\u2500\u2500 guest-book.wasm\n\u2502    \u2502    \u2514\u2500\u2500 hello-near.wasm\n\u2502    \u2514\u2500\u2500 main.ava.ts\n\u251c\u2500\u2500 src # contract's code\n\u2502    \u251c\u2500\u2500 batch_actions.rs\n\u2502    \u251c\u2500\u2500 lib.rs\n\u2502    \u251c\u2500\u2500 multiple_contracts.rs\n\u2502    \u2514\u2500\u2500 similar_contracts.rs\n\u251c\u2500\u2500 Cargo.toml # package manager\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 rust-toolchain.toml\n"})})})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"smart-contract",children:"Smart Contract"}),"\n",(0,a.jsx)(e.h3,{id:"batch-actions",children:"Batch Actions"}),"\n",(0,a.jsxs)(e.p,{children:["You can aggregate multiple actions directed towards one same contract into a batched transaction.\nMethods called this way are executed sequentially, with the added benefit that, if one fails then\nthey ",(0,a.jsx)(e.strong,{children:"all get reverted"}),"."]}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"38",end:"41"}),(0,a.jsx)(l.Ey,{fname:"batch_actions.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/batch_actions.ts",start:"5",end:"17"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"batch_actions.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/batch_actions.rs",start:"8",end:"20"})})]}),"\n",(0,a.jsx)(e.h4,{id:"getting-the-last-response",children:"Getting the Last Response"}),"\n",(0,a.jsxs)(e.p,{children:["In this case, the callback has access to the value returned by the ",(0,a.jsx)(e.strong,{children:"last\naction"})," from the chain."]}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"43",end:"46"}),(0,a.jsx)(l.Ey,{fname:"batch_actions.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/batch_actions.ts",start:"19",end:"29"}),(0,a.jsx)(l.Ey,{fname:"utils.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/utils.ts",start:"3",end:"20"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"batch_actions.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/batch_actions.rs",start:"22",end:"35"})})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h3,{id:"calling-multiple-contracts",children:"Calling Multiple Contracts"}),"\n",(0,a.jsxs)(e.p,{children:["A contract can call multiple other contracts. This creates multiple transactions that execute\nall in parallel. If one of them fails the rest ",(0,a.jsx)(e.strong,{children:"ARE NOT REVERTED"}),"."]}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"48",end:"51"}),(0,a.jsx)(l.Ey,{fname:"multiple_contracts.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/multiple_contracts.ts",start:"6",end:"21"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"multiple_contracts.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/multiple_contracts.rs",start:"16",end:"55"})})]}),"\n",(0,a.jsx)(e.h4,{id:"getting-all-responses",children:"Getting All Responses"}),"\n",(0,a.jsxs)(e.p,{children:["In this case, the callback has access to an ",(0,a.jsx)(e.strong,{children:"array of responses"}),", which have either the\nvalue returned by each call, or an error message."]}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"53",end:"58"}),(0,a.jsx)(l.Ey,{fname:"multiple_contracts.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/multiple_contracts.ts",start:"24",end:"41"}),(0,a.jsx)(l.Ey,{fname:"utils.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/utils.ts",start:"3",end:"20"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"multiple_contracts.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/multiple_contracts.rs",start:"58",end:"92"})})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h3,{id:"multiple-calls---same-result-type",children:"Multiple Calls - Same Result Type"}),"\n",(0,a.jsxs)(e.p,{children:["This example is a particular case of the previous one (",(0,a.jsx)(e.a,{href:"#2-calling-multiple-contracts",children:"Calling Multiple Contracts"}),").\nIt simply showcases a different way to check the results by directly accessing the ",(0,a.jsx)(e.code,{children:"promise_result"})," array."]}),"\n",(0,a.jsx)(e.p,{children:"In this case, we call multiple contracts that will return the same type:"}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"65",end:"70"}),(0,a.jsx)(l.Ey,{fname:"similar_contracts.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/similar_contracts.ts",start:"6",end:"35"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"similar_contracts.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/similar_contracts.rs",start:"8",end:"31"})})]}),"\n",(0,a.jsx)(e.h4,{id:"getting-all-responses-1",children:"Getting All Responses"}),"\n",(0,a.jsxs)(e.p,{children:["In this case, the callback again has access to an ",(0,a.jsx)(e.strong,{children:"array of responses"}),", which we can iterate checking the\nresults."]}),"\n",(0,a.jsxs)(l.O2,{children:[(0,a.jsxs)(l.SQ,{value:"js",language:"js",children:[(0,a.jsx)(l.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/contract.ts",start:"62",end:"65"}),(0,a.jsx)(l.Ey,{fname:"similar_contracts.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/similar_contracts.ts",start:"37",end:"54"}),(0,a.jsx)(l.Ey,{fname:"utils.ts",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-ts/src/internal/utils.ts",start:"3",end:"20"})]}),(0,a.jsx)(l.SQ,{value:"rust",language:"rust",children:(0,a.jsx)(l.Ey,{fname:"similar_contracts.rs",url:"https://github.com/near-examples/cross-contract-calls/blob/main/contract-advanced-rs/src/similar_contracts.rs",start:"32",end:"57"})})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h3,{id:"testing-the-contract",children:"Testing the Contract"}),"\n",(0,a.jsx)(e.p,{children:"The contract readily includes a set of unit and sandbox testing to validate its functionality. To execute the tests, run the following commands:"}),"\n",(0,a.jsxs)(r.Z,{groupId:"code-tabs",children:[(0,a.jsx)(c.Z,{value:"js",label:"\ud83c\udf10 JavaScript",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"cd contract-advanced-ts\nyarn\nyarn test\n"})})}),(0,a.jsx)(c.Z,{value:"rust",label:"\ud83e\udd80 Rust",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"cd contract-advanced-rs\ncargo test\n"})})})]}),"\n",(0,a.jsx)(e.admonition,{type:"tip",children:(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"integration tests"})," use a sandbox to create NEAR users and simulate interactions with the contract."]})}),"\n",(0,a.jsx)("hr",{class:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"deploying-the-contract-to-the-near-network",children:"Deploying the Contract to the NEAR network"}),"\n",(0,a.jsx)(e.p,{children:"In order to deploy the contract you will need to create a NEAR account."}),"\n",(0,a.jsxs)(r.Z,{groupId:"cli-tabs",children:[(0,a.jsx)(c.Z,{value:"short",label:"Short",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Create a new account pre-funded by a faucet\nnear create-account <accountId> --useFaucet\n"})})}),(0,a.jsx)(c.Z,{value:"full",label:"Full",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Create a new account pre-funded by a faucet\nnear account create-account sponsor-by-faucet-service <my-new-dev-account>.testnet autogenerate-new-keypair save-to-keychain network-config testnet create\n"})})})]}),"\n",(0,a.jsxs)(e.p,{children:["Go into the directory containing the smart contract (",(0,a.jsx)(e.code,{children:"cd contract-advanced-ts"})," or ",(0,a.jsx)(e.code,{children:"cd contract-advanced-rs"}),"), build and deploy it:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'cargo near build\n\ncargo near deploy <accountId> with-init-call new json-args \'{"hello_account":"hello.near-example.testnet","guestbook_account":"guestbook_account.near-example.testnet","counter_account":"counter_account.near-example.testnet"}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'0 NEAR\' network-config testnet sign-with-keychain send\n'})}),"\n",(0,a.jsx)("hr",{class:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"cli-interacting-with-the-contract",children:"CLI: Interacting with the Contract"}),"\n",(0,a.jsx)(e.p,{children:"To interact with the contract through the console, you can use the following commands:"}),"\n",(0,a.jsxs)(r.Z,{groupId:"cli-tabs",children:[(0,a.jsx)(c.Z,{value:"short",label:"Short",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Execute contracts sequentially\n# Replace <accountId> with your account ID\nnear call <accountId> batch_actions --accountId <accountId> --gas 300000000000000   \n\n# Execute contracts in parallel\n# Replace <accountId> with your account ID\nnear call <accountId>  multiple_contracts --accountId <accountId> --gas 300000000000000   \n\n# Execute multiple instances of the same contract in parallel\n# Replace <accountId> with your account ID\nnear call <accountId> similar_contracts --accountId <accountId> --gas 300000000000000\n"})})}),(0,a.jsx)(c.Z,{value:"full",label:"Full",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Execute contracts sequentially\n# Replace <accountId> with your account ID\nnear contract call-function as-transaction <accountId> batch_actions json-args '{}' prepaid-gas '300.0 Tgas' attached-deposit '0 NEAR' sign-as <accountId> network-config testnet sign-with-keychain send\n\n# Execute contracts in parallel\n# Replace <accountId> with your account ID\nnear contract call-function as-transaction <accountId> multiple_contracts json-args '{}' prepaid-gas '300.0 Tgas' attached-deposit '0 NEAR' sign-as <accountId> network-config testnet sign-with-keychain send\n\n# Execute multiple instances of the same contract in parallel\n# Replace <accountId> with your account ID\nnear contract call-function as-transaction <accountId> similar_contracts json-args '{}' prepaid-gas '300.0 Tgas' attached-deposit '0 NEAR' sign-as <accountId> network-config testnet sign-with-keychain send\n"})})})]}),"\n",(0,a.jsx)(e.admonition,{type:"info",children:(0,a.jsx)(e.p,{children:'If at some point you get an "Exceeded the prepaid gas" error, try to increase the gas amount used within the functions when calling other contracts'})}),"\n",(0,a.jsxs)(e.admonition,{title:"Versioning for this article",type:"note",children:[(0,a.jsx)(e.p,{children:"At the time of this writing, this example works with the following versions:"}),(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["near-cli: ",(0,a.jsx)(e.code,{children:"4.0.13"})]}),"\n",(0,a.jsxs)(e.li,{children:["node: ",(0,a.jsx)(e.code,{children:"18.19.1"})]}),"\n",(0,a.jsxs)(e.li,{children:["rustc: ",(0,a.jsx)(e.code,{children:"1.77.0"})]}),"\n"]})]})]})}function m(t={}){const{wrapper:e}={...(0,s.a)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(p,{...t})}):p(t)}},85162:(t,e,n)=>{n.d(e,{Z:()=>c});n(67294);var a=n(36905);const s={tabItem:"tabItem_Ymn6"};var r=n(85893);function c(t){var e=t.children,n=t.hidden,c=t.className;return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.Z)(s.tabItem,c),hidden:n,children:e})}},74866:(t,e,n)=>{n.d(e,{Z:()=>w});var a=n(67294),s=n(36905),r=n(12466),c=n(16550),l=n(20469),o=n(91980),i=n(67392),u=n(20812);function d(t){var e,n;return null!=(e=null==(n=a.Children.toArray(t).filter((function(t){return"\n"!==t})).map((function(t){if(!t||(0,a.isValidElement)(t)&&((e=t.props)&&"object"==typeof e&&"value"in e))return t;var e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof t.type?t.type:t.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?e:[]}function h(t){var e=t.values,n=t.children;return(0,a.useMemo)((function(){var t=null!=e?e:function(t){return d(t).map((function(t){var e=t.props;return{value:e.value,label:e.label,attributes:e.attributes,default:e.default}}))}(n);return function(t){var e=(0,i.lx)(t,(function(t,e){return t.value===e.value}));if(e.length>0)throw new Error('Docusaurus error: Duplicate values "'+e.map((function(t){return t.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(t),t}),[e,n])}function p(t){var e=t.value;return t.tabValues.some((function(t){return t.value===e}))}function m(t){var e=t.queryString,n=void 0!==e&&e,s=t.groupId,r=(0,c.k6)(),l=function(t){var e=t.queryString,n=void 0!==e&&e,a=t.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:s});return[(0,o._X)(l),(0,a.useCallback)((function(t){if(l){var e=new URLSearchParams(r.location.search);e.set(l,t),r.replace(Object.assign({},r.location,{search:e.toString()}))}}),[l,r])]}function x(t){var e,n,s,r,c=t.defaultValue,o=t.queryString,i=void 0!==o&&o,d=t.groupId,x=h(t),g=(0,a.useState)((function(){return function(t){var e,n=t.defaultValue,a=t.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((function(t){return t.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var s=null!=(e=a.find((function(t){return t.default})))?e:a[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:c,tabValues:x})})),b=g[0],f=g[1],j=m({queryString:i,groupId:d}),v=j[0],y=j[1],w=(e=function(t){return t?"docusaurus.tab."+t:null}({groupId:d}.groupId),n=(0,u.Nk)(e),s=n[0],r=n[1],[s,(0,a.useCallback)((function(t){e&&r.set(t)}),[e,r])]),I=w[0],E=w[1],C=function(){var t=null!=v?v:I;return p({value:t,tabValues:x})?t:null}();return(0,l.Z)((function(){C&&f(C)}),[C]),{selectedValue:b,selectValue:(0,a.useCallback)((function(t){if(!p({value:t,tabValues:x}))throw new Error("Can't select invalid tab value="+t);f(t),y(t),E(t)}),[y,E,x]),tabValues:x}}var g=n(72389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(85893);function j(t){var e=t.className,n=t.block,a=t.selectedValue,c=t.selectValue,l=t.tabValues,o=[],i=(0,r.o5)().blockElementScrollPositionUntilNextRender,u=function(t){var e=t.currentTarget,n=o.indexOf(e),s=l[n].value;s!==a&&(i(e),c(s))},d=function(t){var e,n=null;switch(t.key){case"Enter":u(t);break;case"ArrowRight":var a,s=o.indexOf(t.currentTarget)+1;n=null!=(a=o[s])?a:o[0];break;case"ArrowLeft":var r,c=o.indexOf(t.currentTarget)-1;n=null!=(r=o[c])?r:o[o.length-1]}null==(e=n)||e.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":n},e),children:l.map((function(t){var e=t.value,n=t.label,r=t.attributes;return(0,f.jsx)("li",Object.assign({role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:function(t){return o.push(t)},onKeyDown:d,onClick:u},r,{className:(0,s.Z)("tabs__item",b.tabItem,null==r?void 0:r.className,{"tabs__item--active":a===e}),children:null!=n?n:e}),e)}))})}function v(t){var e=t.lazy,n=t.children,r=t.selectedValue,c=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){var l=c.find((function(t){return t.props.value===r}));return l?(0,a.cloneElement)(l,{className:(0,s.Z)("margin-top--md",l.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:c.map((function(t,e){return(0,a.cloneElement)(t,{key:e,hidden:t.props.value!==r})}))})}function y(t){var e=x(t);return(0,f.jsxs)("div",{className:(0,s.Z)("tabs-container",b.tabList),children:[(0,f.jsx)(j,Object.assign({},e,t)),(0,f.jsx)(v,Object.assign({},e,t))]})}function w(t){var e=(0,g.Z)();return(0,f.jsx)(y,Object.assign({},t,{children:d(t.children)}),String(e))}},71183:(t,e,n)=>{n.d(e,{O2:()=>m,Ey:()=>g,SQ:()=>x});var a=n(67294),s=n(74866),r=n(85162),c=n(74165),l=n(15861),o=n(1841),i=n.n(o),u=n(85893);function d(){return(d=(0,l.Z)((0,c.Z)().mark((function t(e,n,a){var s,r,l,o;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=localStorage.getItem(e+"-until"))&&r>Date.now())){t.next=5;break}s=localStorage.getItem(e),t.next=18;break;case 5:return t.prev=5,t.next=8,fetch(e);case 8:return t.next=10,t.sent.text();case 10:s=t.sent,localStorage.setItem(e,s),localStorage.setItem(e+"-until",Date.now()+6e4),t.next=18;break;case 15:return t.prev=15,t.t0=t.catch(5),t.abrupt("return","Error fetching code, please try reloading");case 18:return l=s.split("\n"),n=n?Number(n)-1:0,a=a?Number(a):l.length,l=l.slice(n,a),o=l.reduce((function(t,e){if(0===e.length)return t;var n=e.match(/^\s+/);return n?Math.min(t,n[0].length):0}),1/0),t.abrupt("return",l.map((function(t){return t.slice(o)})).join("\n"));case 24:case"end":return t.stop()}}),t,null,[[5,15]])})))).apply(this,arguments)}const h=function(t){var e=t.url,n=t.start,s=t.end,r=t.language,c=t.fname,l=t.metastring,o=(0,a.useState)("Loading..."),h=o[0],p=o[1];return(0,a.useEffect)((function(){var t=function(t){var e=t.slice(t.indexOf("https")).split("#"),n=e[0],a=(e[1],new URL(n).pathname.split("/").slice(1)),s=a[0],r=a[1];return a[2],"https://raw.githubusercontent.com/"+s+"/"+r+"/"+a[3]+"/"+a.slice(4).join("/")}(e),a=function(t,e,n){return d.apply(this,arguments)}(t,n,s);a.then((function(t){return p(t)}))})),(0,u.jsxs)("div",{fname:c,children:[(0,u.jsx)(i(),{language:r,metastring:l+" showLineNumbers",children:h}),(0,u.jsx)("div",{style:{fontSize:"0.9em",fontWeight:600,color:"rgb(14, 117, 221)",textAlign:"center",paddingBottom:"13px",textDecoration:"underline"},children:(0,u.jsx)("a",{href:e,target:"_blank",rel:"noreferrer noopener",children:"See full example on GitHub"})})]})};var p={rust:"\ud83e\udd80 Rust",js:"\ud83c\udf10 Javascript",ts:"\ud83c\udf10 Typescript"};function m(t){var e=t.children;return Array.isArray(e)||(e=[e]),(0,u.jsx)(s.Z,{className:"language-tabs",groupId:"code-tabs",children:e.map((function(t,e){return(0,u.jsx)(r.Z,{value:t.props.value,label:p[t.props.value],children:t})}))})}function x(t){var e=t.children,n=t.language,a=t.showSingleFName;return Array.isArray(e)||(e=[e]),e=e.map((function(t){return function(t,e){var n=t.props,a=(n.children,n.url),s=n.start,r=n.end,c=n.fname;if(t.type===g)return g({url:a,start:s,end:r,language:e,fname:c});return t}(t,n)})),1!=e.length||a?(0,u.jsx)(s.Z,{className:"file-tabs",children:e.map((function(t,e){return(0,u.jsx)(r.Z,{value:e,label:t.props.fname,children:t})}))}):(0,u.jsx)(r.Z,{value:0,label:e[0].props.fname,children:e[0]})}function g(t){var e=t.url,n=t.start,a=t.end,s=t.language,r=t.fname,c=t.metastring;return h({url:e,start:n,end:a,language:s,fname:r,metastring:c})}}}]);